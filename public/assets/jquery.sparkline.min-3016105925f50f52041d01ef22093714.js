!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){"use strict";var e,i,n,s,a,o,r,l,h,c,u,d,p,f,g,m,v,y,b,x,_,w,C,k,S,D,T,M,I,F,A,P,E={},$=0;e=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0,tooltipFormat:new n('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0,tooltipFormat:new n('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new n('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:void 0,thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,tooltipFormat:new n("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:void 0,tooltipFormat:new n("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new n('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0,tooltipFormat:new n("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},D='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',i=function(){var e,i;return e=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(e.prototype=t.extend(new arguments[0],arguments[arguments.length-1]),e._super=arguments[0].prototype):e.prototype=arguments[arguments.length-1],arguments.length>2&&(i=Array.prototype.slice.call(arguments,1,-1),i.unshift(e.prototype),t.extend.apply(t,i))):e.prototype=arguments[0],e.prototype.cls=e,e},t.SPFormatClass=n=i({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(t,e){this.format=t,this.fclass=e},render:function(t,e,i){var n,s,a,o,r,l=this,c=t;return this.format.replace(this.fre,function(){var t;return s=arguments[1],a=arguments[3],n=l.precre.exec(s),n?(r=n[2],s=n[1]):r=!1,o=c[s],void 0===o?"":a&&e&&e[a]?(t=e[a],t.get?e[a].get(o)||o:e[a][o]||o):(h(o)&&(o=i.get("numberFormatter")?i.get("numberFormatter")(o):f(o,r,i.get("numberDigitGroupCount"),i.get("numberDigitGroupSep"),i.get("numberDecimalMark"))),o)})}}),t.spformat=function(t,e){return new n(t,e)},s=function(t,e,i){return e>t?e:t>i?i:t},a=function(t,e){var i;return 2===e?(i=Math.floor(t.length/2),t.length%2?t[i]:(t[i-1]+t[i])/2):t.length%2?(i=(t.length*e+e)/4,i%1?(t[Math.floor(i)]+t[Math.floor(i)-1])/2:t[i-1]):(i=(t.length*e+2)/4,i%1?(t[Math.floor(i)]+t[Math.floor(i)-1])/2:t[i-1])},o=function(t){var e;switch(t){case"undefined":t=void 0;break;case"null":t=null;break;case"true":t=!0;break;case"false":t=!1;break;default:e=parseFloat(t),t==e&&(t=e)}return t},r=function(t){var e,i=[];for(e=t.length;e--;)i[e]=o(t[e]);return i},l=function(t,e){var i,n,s=[];for(i=0,n=t.length;n>i;i++)t[i]!==e&&s.push(t[i]);return s},h=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},f=function(e,i,n,s,a){var o,r;for(e=(i===!1?parseFloat(e).toString():e.toFixed(i)).split(""),o=(o=t.inArray(".",e))<0?e.length:o,o<e.length&&(e[o]=a),r=o-n;r>0;r-=n)e.splice(r,0,s);return e.join("")},c=function(t,e,i){var n;for(n=e.length;n--;)if((!i||null!==e[n])&&e[n]!==t)return!1;return!0},u=function(t){var e,i=0;for(e=t.length;e--;)i+="number"==typeof t[e]?t[e]:0;return i},p=function(e){return t.isArray(e)?e:[e]},d=function(t){var e;document.createStyleSheet?document.createStyleSheet().cssText=t:(e=document.createElement("style"),e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e),e["string"==typeof document.body.style.WebkitAppearance?"innerText":"innerHTML"]=t)},t.fn.simpledraw=function(e,i,n,s){var a,o;if(n&&(a=this.data("_jqs_vcanvas")))return a;if(void 0===e&&(e=t(this).innerWidth()),void 0===i&&(i=t(this).innerHeight()),t.fn.sparkline.hasCanvas)a=new F(e,i,this,s);else{if(!t.fn.sparkline.hasVML)return!1;a=new A(e,i,this)}return o=t(this).data("_jqs_mhandler"),o&&o.registerCanvas(a),a},t.fn.cleardraw=function(){var t=this.data("_jqs_vcanvas");t&&t.reset()},t.RangeMapClass=g=i({init:function(t){var e,i,n=[];for(e in t)t.hasOwnProperty(e)&&"string"==typeof e&&e.indexOf(":")>-1&&(i=e.split(":"),i[0]=0===i[0].length?-1/0:parseFloat(i[0]),i[1]=0===i[1].length?1/0:parseFloat(i[1]),i[2]=t[e],n.push(i));this.map=t,this.rangelist=n||!1},get:function(t){var e,i,n,s=this.rangelist;if(void 0!==(n=this.map[t]))return n;if(s)for(e=s.length;e--;)if(i=s[e],i[0]<=t&&i[1]>=t)return i[2];return void 0}}),t.range_map=function(t){return new g(t)},m=i({init:function(e,i){var n=t(e);this.$el=n,this.options=i,this.currentPageX=0,this.currentPageY=0,this.el=e,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!i.get("disableTooltips"),this.highlightEnabled=!i.get("disableHighlight")},registerSparkline:function(t){this.splist.push(t),this.over&&this.updateDisplay()},registerCanvas:function(e){var i=t(e.canvas);this.canvas=e,this.$canvas=i,i.mouseenter(t.proxy(this.mouseenter,this)),i.mouseleave(t.proxy(this.mouseleave,this)),i.click(t.proxy(this.mouseclick,this))},reset:function(t){this.splist=[],this.tooltip&&t&&(this.tooltip.remove(),this.tooltip=void 0)},mouseclick:function(e){var i=t.Event("sparklineClick");i.originalEvent=e,i.sparklines=this.splist,this.$el.trigger(i)},mouseenter:function(e){t(document.body).unbind("mousemove.jqs"),t(document.body).bind("mousemove.jqs",t.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=e.pageX,this.currentPageY=e.pageY,this.currentEl=e.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new v(this.options),this.tooltip.updatePosition(e.pageX,e.pageY)),this.updateDisplay()},mouseleave:function(){t(document.body).unbind("mousemove.jqs");var e,i,n=this.splist,s=n.length,a=!1;for(this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null),i=0;s>i;i++)e=n[i],e.clearRegionHighlight()&&(a=!0);a&&this.canvas.render()},mousemove:function(t){this.currentPageX=t.pageX,this.currentPageY=t.pageY,this.currentEl=t.target,this.tooltip&&this.tooltip.updatePosition(t.pageX,t.pageY),this.updateDisplay()},updateDisplay:function(){var e,i,n,s,a,o=this.splist,r=o.length,l=!1,h=this.$canvas.offset(),c=this.currentPageX-h.left,u=this.currentPageY-h.top;if(this.over){for(n=0;r>n;n++)i=o[n],s=i.setRegionHighlight(this.currentEl,c,u),s&&(l=!0);if(l){if(a=t.Event("sparklineRegionChange"),a.sparklines=this.splist,this.$el.trigger(a),this.tooltip){for(e="",n=0;r>n;n++)i=o[n],e+=i.getCurrentRegionTooltip();this.tooltip.setContent(e)}this.disableHighlight||this.canvas.render()}null===s&&this.mouseleave()}}}),v=i({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(e){var i,n=e.get("tooltipClassname","jqstooltip"),s=this.sizeStyle;this.container=e.get("tooltipContainer")||document.body,this.tooltipOffsetX=e.get("tooltipOffsetX",10),this.tooltipOffsetY=e.get("tooltipOffsetY",12),t("#jqssizetip").remove(),t("#jqstooltip").remove(),this.sizetip=t("<div/>",{id:"jqssizetip",style:s,"class":n}),this.tooltip=t("<div/>",{id:"jqstooltip","class":n}).appendTo(this.container),i=this.tooltip.offset(),this.offsetLeft=i.left,this.offsetTop=i.top,this.hidden=!0,t(window).unbind("resize.jqs scroll.jqs"),t(window).bind("resize.jqs scroll.jqs",t.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=t(window).scrollTop(),this.scrollLeft=t(window).scrollLeft(),this.scrollRight=this.scrollLeft+t(window).width(),this.updatePosition()},getSize:function(t){this.sizetip.html(t).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(t){return t?(this.getSize(t),this.tooltip.html(t).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition()),void 0):(this.tooltip.css("visibility","hidden"),this.hidden=!0,void 0)},updatePosition:function(t,e){if(void 0===t){if(void 0===this.mousex)return;t=this.mousex-this.offsetLeft,e=this.mousey-this.offsetTop}else this.mousex=t-=this.offsetLeft,this.mousey=e-=this.offsetTop;this.height&&this.width&&!this.hidden&&(e-=this.height+this.tooltipOffsetY,t+=this.tooltipOffsetX,e<this.scrollTop&&(e=this.scrollTop),t<this.scrollLeft?t=this.scrollLeft:t+this.width>this.scrollRight&&(t=this.scrollRight-this.width),this.tooltip.css({left:t,top:e}))},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=void 0,t(window).unbind("resize.jqs scroll.jqs")}}),T=function(){d(D)},t(T),P=[],t.fn.sparkline=function(e,i){return this.each(function(){var n,s,a=new t.fn.sparkline.options(this,i),o=t(this);if(n=function(){var i,n,s,r,l,h,c;return"html"===e||void 0===e?(c=this.getAttribute(a.get("tagValuesAttribute")),(void 0===c||null===c)&&(c=o.html()),i=c.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")):i=e,n="auto"===a.get("width")?i.length*a.get("defaultPixelsPerValue"):a.get("width"),"auto"===a.get("height")?a.get("composite")&&t.data(this,"_jqs_vcanvas")||(r=document.createElement("span"),r.innerHTML="a",o.html(r),s=t(r).innerHeight()||t(r).height(),t(r).remove(),r=null):s=a.get("height"),a.get("disableInteraction")?l=!1:(l=t.data(this,"_jqs_mhandler"),l?a.get("composite")||l.reset():(l=new m(this,a),t.data(this,"_jqs_mhandler",l))),a.get("composite")&&!t.data(this,"_jqs_vcanvas")?(t.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),t.data(this,"_jqs_errnotify",!0)),void 0):(h=new(t.fn.sparkline[a.get("type")])(this,i,a,n,s),h.render(),l&&l.registerSparkline(h),void 0)},t(this).html()&&!a.get("disableHiddenCheck")&&t(this).is(":hidden")||t.fn.jquery<"1.3.0"&&t(this).parents().is(":hidden")||!t(this).parents("body").length){if(!a.get("composite")&&t.data(this,"_jqs_pending"))for(s=P.length;s;s--)P[s-1][0]==this&&P.splice(s-1,1);P.push([this,n]),t.data(this,"_jqs_pending",!0)}else n.call(this)})},t.fn.sparkline.defaults=e(),t.sparkline_display_visible=function(){var e,i,n,s=[];for(i=0,n=P.length;n>i;i++)e=P[i][0],t(e).is(":visible")&&!t(e).parents().is(":hidden")?(P[i][1].call(e),t.data(P[i][0],"_jqs_pending",!1),s.push(i)):!t(e).closest("html").length&&!t.data(e,"_jqs_pending")&&(t.data(P[i][0],"_jqs_pending",!1),s.push(i));for(i=s.length;i;i--)P.splice(s[i-1],1)},t.fn.sparkline.options=i({init:function(e,i){var n,s,a,o;this.userOptions=i=i||{},this.tag=e,this.tagValCache={},s=t.fn.sparkline.defaults,a=s.common,this.tagOptionsPrefix=i.enableTagOptions&&(i.tagOptionsPrefix||a.tagOptionsPrefix),o=this.getTagSetting("type"),n=o===E?s[i.type||a.type]:s[o],this.mergedOptions=t.extend({},a,n,i)},getTagSetting:function(t){var e,i,n,s,a=this.tagOptionsPrefix;if(a===!1||void 0===a)return E;if(this.tagValCache.hasOwnProperty(t))e=this.tagValCache.key;else{if(e=this.tag.getAttribute(a+t),void 0===e||null===e)e=E;else if("["===e.substr(0,1))for(e=e.substr(1,e.length-2).split(","),i=e.length;i--;)e[i]=o(e[i].replace(/(^\s*)|(\s*$)/g,""));else if("{"===e.substr(0,1))for(n=e.substr(1,e.length-2).split(","),e={},i=n.length;i--;)s=n[i].split(":",2),e[s[0].replace(/(^\s*)|(\s*$)/g,"")]=o(s[1].replace(/(^\s*)|(\s*$)/g,""));else e=o(e);this.tagValCache.key=e}return e},get:function(t,e){var i,n=this.getTagSetting(t);return n!==E?n:void 0===(i=this.mergedOptions[t])?e:i}}),t.fn.sparkline._base=i({disabled:!1,init:function(e,i,n,s,a){this.el=e,this.$el=t(e),this.values=i,this.options=n,this.width=s,this.height=a,this.currentRegion=void 0},initTarget:function(){var t=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),t))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(){},setRegionHighlight:function(t,e,i){var n,s=this.currentRegion,a=!this.options.get("disableHighlight");return e>this.canvasWidth||i>this.canvasHeight||0>e||0>i?null:(n=this.getRegion(t,e,i),s!==n?(void 0!==s&&a&&this.removeHighlight(),this.currentRegion=n,void 0!==n&&a&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return void 0!==this.currentRegion?(this.removeHighlight(),this.currentRegion=void 0,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(){},getCurrentRegionTooltip:function(){var e,i,s,a,o,r,l,h,c,u,d,p,f,g,m=this.options,v="",y=[];if(void 0===this.currentRegion)return"";if(e=this.getCurrentRegionFields(),d=m.get("tooltipFormatter"))return d(this,m,e);if(m.get("tooltipChartTitle")&&(v+='<div class="jqs jqstitle">'+m.get("tooltipChartTitle")+"</div>\n"),i=this.options.get("tooltipFormat"),!i)return"";if(t.isArray(i)||(i=[i]),t.isArray(e)||(e=[e]),l=this.options.get("tooltipFormatFieldlist"),h=this.options.get("tooltipFormatFieldlistKey"),l&&h){for(c=[],r=e.length;r--;)u=e[r][h],-1!=(g=t.inArray(u,l))&&(c[g]=e[r]);e=c}for(s=i.length,f=e.length,r=0;s>r;r++)for(p=i[r],"string"==typeof p&&(p=new n(p)),a=p.fclass||"jqsfield",g=0;f>g;g++)e[g].isNull&&m.get("tooltipSkipNull")||(t.extend(e[g],{prefix:m.get("tooltipPrefix"),suffix:m.get("tooltipSuffix")}),o=p.render(e[g],m.get("tooltipValueLookups"),m),y.push('<div class="'+a+'">'+o+"</div>"));return y.length?v+y.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(t,e){var i,n,a,o,r=e.get("highlightColor"),l=e.get("highlightLighten");if(r)return r;if(l&&(i=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t))){for(a=[],n=4===t.length?16:1,o=0;3>o;o++)a[o]=s(Math.round(parseInt(i[o+1],16)*n*l),0,255);return"rgb("+a.join(",")+")"}return t}}),y={changeHighlight:function(e){var i,n=this.currentRegion,s=this.target,a=this.regionShapes[n];a&&(i=this.renderRegion(n,e),t.isArray(i)||t.isArray(a)?(s.replaceWithShapes(a,i),this.regionShapes[n]=t.map(i,function(t){return t.id})):(s.replaceWithShape(a,i),this.regionShapes[n]=i.id))},render:function(){var e,i,n,s,a=this.values,o=this.target,r=this.regionShapes;if(this.cls._super.render.call(this)){for(n=a.length;n--;)if(e=this.renderRegion(n))if(t.isArray(e)){for(i=[],s=e.length;s--;)e[s].append(),i.push(e[s].id);r[n]=i}else e.append(),r[n]=e.id;else r[n]=null;o.render()}}},t.fn.sparkline.line=b=i(t.fn.sparkline._base,{type:"line",init:function(t,e,i,n,s){b._super.init.call(this,t,e,i,n,s),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(t,e){var i,n=this.regionMap;for(i=n.length;i--;)if(null!==n[i]&&e>=n[i][0]&&e<=n[i][1])return n[i][2];return void 0},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:null===this.yvalues[t],x:this.xvalues[t],y:this.yvalues[t],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:t}},renderHighlight:function(){var t,e,i=this.currentRegion,n=this.target,s=this.vertices[i],a=this.options,o=a.get("spotRadius"),r=a.get("highlightSpotColor"),l=a.get("highlightLineColor");s&&(o&&r&&(t=n.drawCircle(s[0],s[1],o,void 0,r),this.highlightSpotId=t.id,n.insertAfterShape(this.lastShapeId,t)),l&&(e=n.drawLine(s[0],this.canvasTop,s[0],this.canvasTop+this.canvasHeight,l),this.highlightLineId=e.id,n.insertAfterShape(this.lastShapeId,e)))},removeHighlight:function(){var t=this.target;this.highlightSpotId&&(t.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(t.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var t,e,i,n,s,a=this.values,o=a.length,r=this.xvalues,l=this.yvalues,h=this.yminmax;for(t=0;o>t;t++)e=a[t],i="string"==typeof a[t],n="object"==typeof a[t]&&a[t]instanceof Array,s=i&&a[t].split(":"),i&&2===s.length?(r.push(Number(s[0])),l.push(Number(s[1])),h.push(Number(s[1]))):n?(r.push(e[0]),l.push(e[1]),h.push(e[1])):(r.push(t),null===a[t]||"null"===a[t]?l.push(null):(l.push(Number(e)),h.push(Number(e))));this.options.get("xvalues")&&(r=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,h),this.miny=this.minyorg=Math.min.apply(Math,h),this.maxx=Math.max.apply(Math,r),this.minx=Math.min.apply(Math,r),this.xvalues=r,this.yvalues=l,this.yminmax=h},processRangeOptions:function(){var t=this.options,e=t.get("normalRangeMin"),i=t.get("normalRangeMax");void 0!==e&&(e<this.miny&&(this.miny=e),i>this.maxy&&(this.maxy=i)),void 0!==t.get("chartRangeMin")&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.miny)&&(this.miny=t.get("chartRangeMin")),void 0!==t.get("chartRangeMax")&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.maxy)&&(this.maxy=t.get("chartRangeMax")),void 0!==t.get("chartRangeMinX")&&(t.get("chartRangeClipX")||t.get("chartRangeMinX")<this.minx)&&(this.minx=t.get("chartRangeMinX")),void 0!==t.get("chartRangeMaxX")&&(t.get("chartRangeClipX")||t.get("chartRangeMaxX")>this.maxx)&&(this.maxx=t.get("chartRangeMaxX"))},drawNormalRange:function(t,e,i,n,s){var a=this.options.get("normalRangeMin"),o=this.options.get("normalRangeMax"),r=e+Math.round(i-i*((o-this.miny)/s)),l=Math.round(i*(o-a)/s);this.target.drawRect(t,r,n,l,void 0,this.options.get("normalRangeColor")).append()},render:function(){var e,i,n,s,a,o,r,l,h,c,u,d,p,f,m,v,y,x,_,w,C,k,S,D,T,M=this.options,I=this.target,F=this.canvasWidth,A=this.canvasHeight,P=this.vertices,E=M.get("spotRadius"),$=this.regionMap;if(b._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),S=this.xvalues,D=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2))){for(s=a=0,e=0===this.maxx-this.minx?1:this.maxx-this.minx,i=0===this.maxy-this.miny?1:this.maxy-this.miny,n=this.yvalues.length-1,E&&(4*E>F||4*E>A)&&(E=0),E&&(C=M.get("highlightSpotColor")&&!M.get("disableInteraction"),(C||M.get("minSpotColor")||M.get("spotColor")&&D[n]===this.miny)&&(A-=Math.ceil(E)),(C||M.get("maxSpotColor")||M.get("spotColor")&&D[n]===this.maxy)&&(A-=Math.ceil(E),s+=Math.ceil(E)),(C||(M.get("minSpotColor")||M.get("maxSpotColor"))&&(D[0]===this.miny||D[0]===this.maxy))&&(a+=Math.ceil(E),F-=Math.ceil(E)),(C||M.get("spotColor")||M.get("minSpotColor")||M.get("maxSpotColor")&&(D[n]===this.miny||D[n]===this.maxy))&&(F-=Math.ceil(E))),A--,void 0!==M.get("normalRangeMin")&&!M.get("drawNormalOnTop")&&this.drawNormalRange(a,s,A,F,i),r=[],l=[r],f=m=null,v=D.length,T=0;v>T;T++)h=S[T],u=S[T+1],c=D[T],d=a+Math.round((h-this.minx)*(F/e)),p=v-1>T?a+Math.round((u-this.minx)*(F/e)):F,m=d+(p-d)/2,$[T]=[f||0,m,T],f=m,null===c?T&&(null!==D[T-1]&&(r=[],l.push(r)),P.push(null)):(c<this.miny&&(c=this.miny),c>this.maxy&&(c=this.maxy),r.length||r.push([d,s+A]),o=[d,s+Math.round(A-A*((c-this.miny)/i))],r.push(o),P.push(o));for(y=[],x=[],_=l.length,T=0;_>T;T++)r=l[T],r.length&&(M.get("fillColor")&&(r.push([r[r.length-1][0],s+A]),x.push(r.slice(0)),r.pop()),r.length>2&&(r[0]=[r[0][0],r[1][1]]),y.push(r));for(_=x.length,T=0;_>T;T++)I.drawShape(x[T],M.get("fillColor"),M.get("fillColor")).append();for(void 0!==M.get("normalRangeMin")&&M.get("drawNormalOnTop")&&this.drawNormalRange(a,s,A,F,i),_=y.length,T=0;_>T;T++)I.drawShape(y[T],M.get("lineColor"),void 0,M.get("lineWidth")).append();if(E&&M.get("valueSpots"))for(w=M.get("valueSpots"),void 0===w.get&&(w=new g(w)),T=0;v>T;T++)k=w.get(D[T]),k&&I.drawCircle(a+Math.round((S[T]-this.minx)*(F/e)),s+Math.round(A-A*((D[T]-this.miny)/i)),E,void 0,k).append();E&&M.get("spotColor")&&null!==D[n]&&I.drawCircle(a+Math.round((S[S.length-1]-this.minx)*(F/e)),s+Math.round(A-A*((D[n]-this.miny)/i)),E,void 0,M.get("spotColor")).append(),this.maxy!==this.minyorg&&(E&&M.get("minSpotColor")&&(h=S[t.inArray(this.minyorg,D)],I.drawCircle(a+Math.round((h-this.minx)*(F/e)),s+Math.round(A-A*((this.minyorg-this.miny)/i)),E,void 0,M.get("minSpotColor")).append()),E&&M.get("maxSpotColor")&&(h=S[t.inArray(this.maxyorg,D)],I.drawCircle(a+Math.round((h-this.minx)*(F/e)),s+Math.round(A-A*((this.maxyorg-this.miny)/i)),E,void 0,M.get("maxSpotColor")).append())),this.lastShapeId=I.getLastShapeId(),this.canvasTop=s,I.render()}}}),t.fn.sparkline.bar=x=i(t.fn.sparkline._base,y,{type:"bar",init:function(e,i,n,a,h){var c,u,d,p,f,m,v,y,b,_,w,C,k,S,D,T,M,I,F,A,P,E,$=parseInt(n.get("barWidth"),10),N=parseInt(n.get("barSpacing"),10),R=n.get("chartRangeMin"),z=n.get("chartRangeMax"),L=n.get("chartRangeClip"),H=1/0,W=-1/0;for(x._super.init.call(this,e,i,n,a,h),m=0,v=i.length;v>m;m++)A=i[m],c="string"==typeof A&&A.indexOf(":")>-1,(c||t.isArray(A))&&(D=!0,c&&(A=i[m]=r(A.split(":"))),A=l(A,null),u=Math.min.apply(Math,A),d=Math.max.apply(Math,A),H>u&&(H=u),d>W&&(W=d));this.stacked=D,this.regionShapes={},this.barWidth=$,this.barSpacing=N,this.totalBarWidth=$+N,this.width=a=i.length*$+(i.length-1)*N,this.initTarget(),L&&(k=void 0===R?-1/0:R,S=void 0===z?1/0:z),f=[],p=D?[]:f;var O=[],j=[];for(m=0,v=i.length;v>m;m++)if(D)for(T=i[m],i[m]=F=[],O[m]=0,p[m]=j[m]=0,M=0,I=T.length;I>M;M++)A=F[M]=L?s(T[M],k,S):T[M],null!==A&&(A>0&&(O[m]+=A),0>H&&W>0?0>A?j[m]+=Math.abs(A):p[m]+=A:p[m]+=Math.abs(A-(0>A?W:H)),f.push(A));else A=L?s(i[m],k,S):i[m],A=i[m]=o(A),null!==A&&f.push(A);this.max=C=Math.max.apply(Math,f),this.min=w=Math.min.apply(Math,f),this.stackMax=W=D?Math.max.apply(Math,O):C,this.stackMin=H=D?Math.min.apply(Math,f):w,void 0!==n.get("chartRangeMin")&&(n.get("chartRangeClip")||n.get("chartRangeMin")<w)&&(w=n.get("chartRangeMin")),void 0!==n.get("chartRangeMax")&&(n.get("chartRangeClip")||n.get("chartRangeMax")>C)&&(C=n.get("chartRangeMax")),this.zeroAxis=b=n.get("zeroAxis",!0),_=0>=w&&C>=0&&b?0:0==b?w:w>0?w:C,this.xaxisOffset=_,y=D?Math.max.apply(Math,p)+Math.max.apply(Math,j):C-w,this.canvasHeightEf=b&&0>w?this.canvasHeight-2:this.canvasHeight-1,_>w?(E=D&&C>=0?W:C,P=(E-_)/y*this.canvasHeight,P!==Math.ceil(P)&&(this.canvasHeightEf-=2,P=Math.ceil(P))):P=this.canvasHeight,this.yoffset=P,t.isArray(n.get("colorMap"))?(this.colorMapByIndex=n.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=n.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new g(this.colorMapByValue))),this.range=y},getRegion:function(t,e){var i=Math.floor(e/this.totalBarWidth);return 0>i||i>=this.values.length?void 0:i},getCurrentRegionFields:function(){var t,e,i=this.currentRegion,n=p(this.values[i]),s=[];for(e=n.length;e--;)t=n[e],s.push({isNull:null===t,value:t,color:this.calcColor(e,t,i),offset:i});return s},calcColor:function(e,i,n){var s,a,o=this.colorMapByIndex,r=this.colorMapByValue,l=this.options;return s=this.stacked?l.get("stackedBarColor"):0>i?l.get("negBarColor"):l.get("barColor"),0===i&&void 0!==l.get("zeroColor")&&(s=l.get("zeroColor")),r&&(a=r.get(i))?s=a:o&&o.length>n&&(s=o[n]),t.isArray(s)?s[e%s.length]:s},renderRegion:function(e,i){var n,s,a,o,r,l,h,u,d,p,f=this.values[e],g=this.options,m=this.xaxisOffset,v=[],y=this.range,b=this.stacked,x=this.target,_=e*this.totalBarWidth,w=this.canvasHeightEf,C=this.yoffset;if(f=t.isArray(f)?f:[f],h=f.length,u=f[0],o=c(null,f),p=c(m,f,!0),o)return g.get("nullColor")?(a=i?g.get("nullColor"):this.calcHighlightColor(g.get("nullColor"),g),n=C>0?C-1:C,x.drawRect(_,n,this.barWidth-1,0,a,a)):void 0;for(r=C,l=0;h>l;l++){if(u=f[l],b&&u===m){if(!p||d)continue;d=!0}s=y>0?Math.floor(w*(Math.abs(u-m)/y))+1:1,m>u||u===m&&0===C?(n=r,r+=s):(n=C-s,C-=s),a=this.calcColor(l,u,e),i&&(a=this.calcHighlightColor(a,g)),v.push(x.drawRect(_,n,this.barWidth-1,s-1,a,a))}return 1===v.length?v[0]:v}}),t.fn.sparkline.tristate=_=i(t.fn.sparkline._base,y,{type:"tristate",init:function(e,i,n,s,a){var o=parseInt(n.get("barWidth"),10),r=parseInt(n.get("barSpacing"),10);_._super.init.call(this,e,i,n,s,a),this.regionShapes={},this.barWidth=o,this.barSpacing=r,this.totalBarWidth=o+r,this.values=t.map(i,Number),this.width=s=i.length*o+(i.length-1)*r,t.isArray(n.get("colorMap"))?(this.colorMapByIndex=n.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=n.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new g(this.colorMapByValue))),this.initTarget()},getRegion:function(t,e){return Math.floor(e/this.totalBarWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:void 0===this.values[t],value:this.values[t],color:this.calcColor(this.values[t],t),offset:t}},calcColor:function(t,e){var i,n,s=this.values,a=this.options,o=this.colorMapByIndex,r=this.colorMapByValue;return i=r&&(n=r.get(t))?n:o&&o.length>e?o[e]:s[e]<0?a.get("negBarColor"):s[e]>0?a.get("posBarColor"):a.get("zeroBarColor")},renderRegion:function(t,e){var i,n,s,a,o,r,l=this.values,h=this.options,c=this.target;return i=c.pixelHeight,s=Math.round(i/2),a=t*this.totalBarWidth,l[t]<0?(o=s,n=s-1):l[t]>0?(o=0,n=s-1):(o=s-1,n=2),r=this.calcColor(l[t],t),null!==r?(e&&(r=this.calcHighlightColor(r,h)),c.drawRect(a,o,this.barWidth-1,n-1,r,r)):void 0}}),t.fn.sparkline.discrete=w=i(t.fn.sparkline._base,y,{type:"discrete",init:function(e,i,n,s,a){w._super.init.call(this,e,i,n,s,a),this.regionShapes={},this.values=i=t.map(i,Number),this.min=Math.min.apply(Math,i),this.max=Math.max.apply(Math,i),this.range=this.max-this.min,this.width=s="auto"===n.get("width")?2*i.length:this.width,this.interval=Math.floor(s/i.length),this.itemWidth=s/i.length,void 0!==n.get("chartRangeMin")&&(n.get("chartRangeClip")||n.get("chartRangeMin")<this.min)&&(this.min=n.get("chartRangeMin")),void 0!==n.get("chartRangeMax")&&(n.get("chartRangeClip")||n.get("chartRangeMax")>this.max)&&(this.max=n.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight="auto"===n.get("lineHeight")?Math.round(.3*this.canvasHeight):n.get("lineHeight"))},getRegion:function(t,e){return Math.floor(e/this.itemWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:void 0===this.values[t],value:this.values[t],offset:t}},renderRegion:function(t,e){var i,n,a,o,r=this.values,l=this.options,h=this.min,c=this.max,u=this.range,d=this.interval,p=this.target,f=this.canvasHeight,g=this.lineHeight,m=f-g;return n=s(r[t],h,c),o=t*d,i=Math.round(m-m*((n-h)/u)),a=l.get("thresholdColor")&&n<l.get("thresholdValue")?l.get("thresholdColor"):l.get("lineColor"),e&&(a=this.calcHighlightColor(a,l)),p.drawLine(o,i,o,i+g,a)}}),t.fn.sparkline.bullet=C=i(t.fn.sparkline._base,{type:"bullet",init:function(t,e,i,n,s){var a,o,l;C._super.init.call(this,t,e,i,n,s),this.values=e=r(e),l=e.slice(),l[0]=null===l[0]?l[2]:l[0],l[1]=null===e[1]?l[2]:l[1],a=Math.min.apply(Math,e),o=Math.max.apply(Math,e),a=void 0===i.get("base")?0>a?a:0:i.get("base"),this.min=a,this.max=o,this.range=o-a,this.shapes={},this.valueShapes={},this.regiondata={},this.width=n="auto"===i.get("width")?"4.0em":n,this.target=this.$el.simpledraw(n,s,i.get("composite")),e.length||(this.disabled=!0),this.initTarget()},getRegion:function(t,e,i){var n=this.target.getShapeAt(t,e,i);return void 0!==n&&void 0!==this.shapes[n]?this.shapes[n]:void 0},getCurrentRegionFields:function(){var t=this.currentRegion;return{fieldkey:t.substr(0,1),value:this.values[t.substr(1)],region:t}},changeHighlight:function(t){var e,i=this.currentRegion,n=this.valueShapes[i];switch(delete this.shapes[n],i.substr(0,1)){case"r":e=this.renderRange(i.substr(1),t);break;case"p":e=this.renderPerformance(t);break;case"t":e=this.renderTarget(t)}this.valueShapes[i]=e.id,this.shapes[e.id]=i,this.target.replaceWithShape(n,e)},renderRange:function(t,e){var i=this.values[t],n=Math.round(this.canvasWidth*((i-this.min)/this.range)),s=this.options.get("rangeColors")[t-2];return e&&(s=this.calcHighlightColor(s,this.options)),this.target.drawRect(0,0,n-1,this.canvasHeight-1,s,s)},renderPerformance:function(t){var e=this.values[1],i=Math.round(this.canvasWidth*((e-this.min)/this.range)),n=this.options.get("performanceColor");return t&&(n=this.calcHighlightColor(n,this.options)),this.target.drawRect(0,Math.round(.3*this.canvasHeight),i-1,Math.round(.4*this.canvasHeight)-1,n,n)},renderTarget:function(t){var e=this.values[0],i=Math.round(this.canvasWidth*((e-this.min)/this.range)-this.options.get("targetWidth")/2),n=Math.round(.1*this.canvasHeight),s=this.canvasHeight-2*n,a=this.options.get("targetColor");return t&&(a=this.calcHighlightColor(a,this.options)),this.target.drawRect(i,n,this.options.get("targetWidth")-1,s-1,a,a)},render:function(){var t,e,i=this.values.length,n=this.target;if(C._super.render.call(this)){for(t=2;i>t;t++)e=this.renderRange(t).append(),this.shapes[e.id]="r"+t,this.valueShapes["r"+t]=e.id;null!==this.values[1]&&(e=this.renderPerformance().append(),this.shapes[e.id]="p1",this.valueShapes.p1=e.id),null!==this.values[0]&&(e=this.renderTarget().append(),this.shapes[e.id]="t0",this.valueShapes.t0=e.id),n.render()}}}),t.fn.sparkline.pie=k=i(t.fn.sparkline._base,{type:"pie",init:function(e,i,n,s,a){var o,r=0;if(k._super.init.call(this,e,i,n,s,a),this.shapes={},this.valueShapes={},this.values=i=t.map(i,Number),"auto"===n.get("width")&&(this.width=this.height),i.length>0)for(o=i.length;o--;)r+=i[o];this.total=r,this.initTarget(),this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(t,e,i){var n=this.target.getShapeAt(t,e,i);return void 0!==n&&void 0!==this.shapes[n]?this.shapes[n]:void 0},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:void 0===this.values[t],value:this.values[t],percent:100*(this.values[t]/this.total),color:this.options.get("sliceColors")[t%this.options.get("sliceColors").length],offset:t}},changeHighlight:function(t){var e=this.currentRegion,i=this.renderSlice(e,t),n=this.valueShapes[e];delete this.shapes[n],this.target.replaceWithShape(n,i),this.valueShapes[e]=i.id,this.shapes[i.id]=e},renderSlice:function(t,e){var i,n,s,a,o,r=this.target,l=this.options,h=this.radius,c=l.get("borderWidth"),u=l.get("offset"),d=2*Math.PI,p=this.values,f=this.total,g=u?2*Math.PI*(u/360):0;for(a=p.length,s=0;a>s;s++){if(i=g,n=g,f>0&&(n=g+d*(p[s]/f)),t===s)return o=l.get("sliceColors")[s%l.get("sliceColors").length],e&&(o=this.calcHighlightColor(o,l)),r.drawPieSlice(h,h,h-c,i,n,void 0,o);g=n}},render:function(){var t,e,i=this.target,n=this.values,s=this.options,a=this.radius,o=s.get("borderWidth");if(k._super.render.call(this)){for(o&&i.drawCircle(a,a,Math.floor(a-o/2),s.get("borderColor"),void 0,o).append(),e=n.length;e--;)n[e]&&(t=this.renderSlice(e).append(),this.valueShapes[e]=t.id,this.shapes[t.id]=e);i.render()}}}),t.fn.sparkline.box=S=i(t.fn.sparkline._base,{type:"box",init:function(e,i,n,s,a){S._super.init.call(this,e,i,n,s,a),this.values=t.map(i,Number),this.width="auto"===n.get("width")?"4.0em":s,this.initTarget(),this.values.length||(this.disabled=1)
},getRegion:function(){return 1},getCurrentRegionFields:function(){var t=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return void 0!==this.loutlier&&t.push({field:"lo",value:this.loutlier}),void 0!==this.routlier&&t.push({field:"ro",value:this.routlier}),void 0!==this.lwhisker&&t.push({field:"lw",value:this.lwhisker}),void 0!==this.rwhisker&&t.push({field:"rw",value:this.rwhisker}),t},render:function(){var t,e,i,n,s,o,r,l,h,c,u,d=this.target,p=this.values,f=p.length,g=this.options,m=this.canvasWidth,v=this.canvasHeight,y=void 0===g.get("chartRangeMin")?Math.min.apply(Math,p):g.get("chartRangeMin"),b=void 0===g.get("chartRangeMax")?Math.max.apply(Math,p):g.get("chartRangeMax"),x=0;if(S._super.render.call(this)){if(g.get("raw"))g.get("showOutliers")&&p.length>5?(e=p[0],t=p[1],n=p[2],s=p[3],o=p[4],r=p[5],l=p[6]):(t=p[0],n=p[1],s=p[2],o=p[3],r=p[4]);else if(p.sort(function(t,e){return t-e}),n=a(p,1),s=a(p,2),o=a(p,3),i=o-n,g.get("showOutliers")){for(t=r=void 0,h=0;f>h;h++)void 0===t&&p[h]>n-i*g.get("outlierIQR")&&(t=p[h]),p[h]<o+i*g.get("outlierIQR")&&(r=p[h]);e=p[0],l=p[f-1]}else t=p[0],r=p[f-1];this.quartiles=[n,s,o],this.lwhisker=t,this.rwhisker=r,this.loutlier=e,this.routlier=l,u=m/(b-y+1),g.get("showOutliers")&&(x=Math.ceil(g.get("spotRadius")),m-=2*Math.ceil(g.get("spotRadius")),u=m/(b-y+1),t>e&&d.drawCircle((e-y)*u+x,v/2,g.get("spotRadius"),g.get("outlierLineColor"),g.get("outlierFillColor")).append(),l>r&&d.drawCircle((l-y)*u+x,v/2,g.get("spotRadius"),g.get("outlierLineColor"),g.get("outlierFillColor")).append()),d.drawRect(Math.round((n-y)*u+x),Math.round(.1*v),Math.round((o-n)*u),Math.round(.8*v),g.get("boxLineColor"),g.get("boxFillColor")).append(),d.drawLine(Math.round((t-y)*u+x),Math.round(v/2),Math.round((n-y)*u+x),Math.round(v/2),g.get("lineColor")).append(),d.drawLine(Math.round((t-y)*u+x),Math.round(v/4),Math.round((t-y)*u+x),Math.round(v-v/4),g.get("whiskerColor")).append(),d.drawLine(Math.round((r-y)*u+x),Math.round(v/2),Math.round((o-y)*u+x),Math.round(v/2),g.get("lineColor")).append(),d.drawLine(Math.round((r-y)*u+x),Math.round(v/4),Math.round((r-y)*u+x),Math.round(v-v/4),g.get("whiskerColor")).append(),d.drawLine(Math.round((s-y)*u+x),Math.round(.1*v),Math.round((s-y)*u+x),Math.round(.9*v),g.get("medianColor")).append(),g.get("target")&&(c=Math.ceil(g.get("spotRadius")),d.drawLine(Math.round((g.get("target")-y)*u+x),Math.round(v/2-c),Math.round((g.get("target")-y)*u+x),Math.round(v/2+c),g.get("targetColor")).append(),d.drawLine(Math.round((g.get("target")-y)*u+x-c),Math.round(v/2),Math.round((g.get("target")-y)*u+x+c),Math.round(v/2),g.get("targetColor")).append()),d.render()}}}),function(){document.namespaces&&!document.namespaces.v?(t.fn.sparkline.hasVML=!0,document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML")):t.fn.sparkline.hasVML=!1;var e=document.createElement("canvas");t.fn.sparkline.hasCanvas=!!e.getContext&&!!e.getContext("2d")}(),M=i({init:function(t,e,i,n){this.target=t,this.id=e,this.type=i,this.args=n},append:function(){return this.target.appendShape(this),this}}),I=i({_pxregex:/(\d+)(px)?\s*$/i,init:function(e,i,n){e&&(this.width=e,this.height=i,this.target=n,this.lastShapeId=null,n[0]&&(n=n[0]),t.data(n,"_jqs_vcanvas",this))},drawLine:function(t,e,i,n,s,a){return this.drawShape([[t,e],[i,n]],s,a)},drawShape:function(t,e,i,n){return this._genShape("Shape",[t,e,i,n])},drawCircle:function(t,e,i,n,s,a){return this._genShape("Circle",[t,e,i,n,s,a])},drawPieSlice:function(t,e,i,n,s,a,o){return this._genShape("PieSlice",[t,e,i,n,s,a,o])},drawRect:function(t,e,i,n,s,a){return this._genShape("Rect",[t,e,i,n,s,a])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(e,i){t(i).html(e)},_calculatePixelDims:function(e,i,n){var s;s=this._pxregex.exec(i),this.pixelHeight=s?s[1]:t(n).height(),s=this._pxregex.exec(e),this.pixelWidth=s?s[1]:t(n).width()},_genShape:function(t,e){var i=$++;return e.unshift(i),new M(this,i,t,e)},appendShape:function(){alert("appendShape not implemented")},replaceWithShape:function(){alert("replaceWithShape not implemented")},insertAfterShape:function(){alert("insertAfterShape not implemented")},removeShapeId:function(){alert("removeShapeId not implemented")},getShapeAt:function(){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),F=i(I,{init:function(e,i,n,s){F._super.init.call(this,e,i,n),this.canvas=document.createElement("canvas"),n[0]&&(n=n[0]),t.data(n,"_jqs_vcanvas",this),t(this.canvas).css({display:"inline-block",width:e,height:i,verticalAlign:"top"}),this._insert(this.canvas,n),this._calculatePixelDims(e,i,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=s,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0,t(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(t,e,i){var n=this.canvas.getContext("2d");return void 0!==t&&(n.strokeStyle=t),n.lineWidth=void 0===i?1:i,void 0!==e&&(n.fillStyle=e),n},reset:function(){var t=this._getContext();t.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0},_drawShape:function(t,e,i,n,s){var a,o,r=this._getContext(i,n,s);for(r.beginPath(),r.moveTo(e[0][0]+.5,e[0][1]+.5),a=1,o=e.length;o>a;a++)r.lineTo(e[a][0]+.5,e[a][1]+.5);void 0!==i&&r.stroke(),void 0!==n&&r.fill(),void 0!==this.targetX&&void 0!==this.targetY&&r.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawCircle:function(t,e,i,n,s,a,o){var r=this._getContext(s,a,o);r.beginPath(),r.arc(e,i,n,0,2*Math.PI,!1),void 0!==this.targetX&&void 0!==this.targetY&&r.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t),void 0!==s&&r.stroke(),void 0!==a&&r.fill()},_drawPieSlice:function(t,e,i,n,s,a,o,r){var l=this._getContext(o,r);l.beginPath(),l.moveTo(e,i),l.arc(e,i,n,s,a,!1),l.lineTo(e,i),l.closePath(),void 0!==o&&l.stroke(),r&&l.fill(),void 0!==this.targetX&&void 0!==this.targetY&&l.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawRect:function(t,e,i,n,s,a,o){return this._drawShape(t,[[e,i],[e+n,i],[e+n,i+s],[e,i+s],[e,i]],a,o)},appendShape:function(t){return this.shapes[t.id]=t,this.shapeseq.push(t.id),this.lastShapeId=t.id,t.id},replaceWithShape:function(t,e){var i,n=this.shapeseq;for(this.shapes[e.id]=e,i=n.length;i--;)n[i]==t&&(n[i]=e.id);delete this.shapes[t]},replaceWithShapes:function(t,e){var i,n,s,a=this.shapeseq,o={};for(n=t.length;n--;)o[t[n]]=!0;for(n=a.length;n--;)i=a[n],o[i]&&(a.splice(n,1),delete this.shapes[i],s=n);for(n=e.length;n--;)a.splice(s,0,e[n].id),this.shapes[e[n].id]=e[n]},insertAfterShape:function(t,e){var i,n=this.shapeseq;for(i=n.length;i--;)if(n[i]===t)return n.splice(i+1,0,e.id),this.shapes[e.id]=e,void 0},removeShapeId:function(t){var e,i=this.shapeseq;for(e=i.length;e--;)if(i[e]===t){i.splice(e,1);break}delete this.shapes[t]},getShapeAt:function(t,e,i){return this.targetX=e,this.targetY=i,this.render(),this.currentTargetShapeId},render:function(){var t,e,i,n=this.shapeseq,s=this.shapes,a=n.length,o=this._getContext();for(o.clearRect(0,0,this.pixelWidth,this.pixelHeight),i=0;a>i;i++)t=n[i],e=s[t],this["_draw"+e.type].apply(this,e.args);this.interact||(this.shapes={},this.shapeseq=[])}}),A=i(I,{init:function(e,i,n){var s;A._super.init.call(this,e,i,n),n[0]&&(n=n[0]),t.data(n,"_jqs_vcanvas",this),this.canvas=document.createElement("span"),t(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:e,height:i,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,n),this._calculatePixelDims(e,i,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,s='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"'+' style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",s),this.group=t(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(t,e,i,n,s){var a,o,r,l,h,c,u,d=[];for(u=0,c=e.length;c>u;u++)d[u]=""+e[u][0]+","+e[u][1];return a=d.splice(0,1),s=void 0===s?1:s,o=void 0===i?' stroked="false" ':' strokeWeight="'+s+'px" strokeColor="'+i+'" ',r=void 0===n?' filled="false"':' fillColor="'+n+'" filled="true" ',l=d[0]===d[d.length-1]?"x ":"",h='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" '+' id="jqsshape'+t+'" '+o+r+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;" '+' path="m '+a+" l "+d.join(", ")+" "+l+'e">'+" </v:shape>"},_drawCircle:function(t,e,i,n,s,a,o){var r,l,h;return e-=n,i-=n,r=void 0===s?' stroked="false" ':' strokeWeight="'+o+'px" strokeColor="'+s+'" ',l=void 0===a?' filled="false"':' fillColor="'+a+'" filled="true" ',h='<v:oval  id="jqsshape'+t+'" '+r+l+' style="position:absolute;top:'+i+"px; left:"+e+"px; width:"+2*n+"px; height:"+2*n+'px"></v:oval>'},_drawPieSlice:function(t,e,i,n,s,a,o,r){var l,h,c,u,d,p,f,g;if(s===a)return"";if(a-s===2*Math.PI&&(s=0,a=2*Math.PI),h=e+Math.round(Math.cos(s)*n),c=i+Math.round(Math.sin(s)*n),u=e+Math.round(Math.cos(a)*n),d=i+Math.round(Math.sin(a)*n),h===u&&c===d){if(a-s<Math.PI)return"";h=u=e+n,c=d=i}return h===u&&c===d&&a-s<Math.PI?"":(l=[e-n,i-n,e+n,i+n,h,c,u,d],p=void 0===o?' stroked="false" ':' strokeWeight="1px" strokeColor="'+o+'" ',f=void 0===r?' filled="false"':' fillColor="'+r+'" filled="true" ',g='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" '+' id="jqsshape'+t+'" '+p+f+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;" '+' path="m '+e+","+i+" wa "+l.join(", ")+' x e">'+" </v:shape>")},_drawRect:function(t,e,i,n,s,a,o){return this._drawShape(t,[[e,i],[e,i+s],[e+n,i+s],[e+n,i],[e,i]],a,o)},reset:function(){this.group.innerHTML=""},appendShape:function(t){var e=this["_draw"+t.type].apply(this,t.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",e):this.prerender+=e,this.lastShapeId=t.id,t.id},replaceWithShape:function(e,i){var n=t("#jqsshape"+e),s=this["_draw"+i.type].apply(this,i.args);n[0].outerHTML=s},replaceWithShapes:function(e,i){var n,s=t("#jqsshape"+e[0]),a="",o=i.length;for(n=0;o>n;n++)a+=this["_draw"+i[n].type].apply(this,i[n].args);for(s[0].outerHTML=a,n=1;n<e.length;n++)t("#jqsshape"+e[n]).remove()},insertAfterShape:function(e,i){var n=t("#jqsshape"+e),s=this["_draw"+i.type].apply(this,i.args);n[0].insertAdjacentHTML("afterEnd",s)},removeShapeId:function(e){var i=t("#jqsshape"+e);this.group.removeChild(i[0])},getShapeAt:function(t){var e=t.id.substr(8);return e},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})});